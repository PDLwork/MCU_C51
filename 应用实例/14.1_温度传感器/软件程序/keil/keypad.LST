C51 COMPILER V9.01   KEYPAD                                                                05/08/2021 18:31:42 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE KEYPAD
OBJECT MODULE PLACED IN keypad.OBJ
COMPILER INVOKED BY: D:\软件\keil\C51\BIN\C51.EXE keypad.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <reg52.h>
   2          #include"userdef.h"
   3          #include"lcd1602.h"
   4          #include"keypad.h"
   5          
   6          bit dismod_change = 1;          //显示模式设置，1为实时显示模式，0为设置报警模式
   7          bit temp_change = 1;       //温度设置标志位，1为设置上限，0为设置下限
   8          char higtemp = 110;             //分别存放报警上下限
   9          char lowtemp = -5;
  10          
  11          static void delay1ms(uint x)  /*延时1毫秒函数*/
  12          { 
  13   1          uint i,j;
  14   1          for(i=0;i<x;i++)
  15   1              for(j=0;j<100;j++);
  16   1      }
  17          
  18          extern void keypadscan(void)             /*键盘读取函数*/
  19          {
  20   1              if(SW_1==0)                        //显示模式转化开关
  21   1              {
  22   2                      delay1ms(10);      //延时10毫秒后再次扫描消抖
  23   2                      if(SW_1==0)
  24   2                      {
  25   3                              lcd_init();    //LCD初始化显示
  26   3                              dismod_change = !dismod_change;
  27   3                              lcd_write_com(0x82);
  28   3                              lcd_disp_alarm(higtemp);
  29   3                              lcd_write_com(0xC2);
  30   3                              lcd_disp_alarm(lowtemp);
  31   3                              while(!SW_1);      //直到松开按钮，防止误触
  32   3                      }       
  33   2              }
  34   1      
  35   1              if(SW_2==0)                        //上下限转换开关
  36   1              {
  37   2                      delay1ms(10);      
  38   2                      if(SW_2==0)
  39   2                      {
  40   3                              temp_change = !temp_change;
  41   3                              while(!SW_2);      
  42   3                      }       
  43   2              }
  44   1      
  45   1              if(SW_3==0)                      //＋1开关
  46   1              {
  47   2                      delay1ms(10);      
  48   2                      if(SW_3==0)
  49   2                      {
  50   3                              if(!dismod_change)
  51   3                              {
  52   4                                      if(temp_change)
  53   4                                              higtemp = higtemp + 1;
  54   4                                      if(!temp_change)
  55   4                                      {
C51 COMPILER V9.01   KEYPAD                                                                05/08/2021 18:31:42 PAGE 2   

  56   5                                              lowtemp = lowtemp + 1;
  57   5                                      }
  58   4                                      lcd_write_com(0x82);
  59   4                                      lcd_disp_alarm(higtemp);
  60   4                                      lcd_write_com(0xC2);
  61   4                                      lcd_disp_alarm(lowtemp);
  62   4                                      lcd_dis_mod(2); 
  63   4                              }
  64   3                              while(!SW_3);      
  65   3                      }       
  66   2              }
  67   1      
  68   1              if(SW_4==0)                     //-1开关
  69   1              {
  70   2                      delay1ms(10);     
  71   2                      if(SW_4==0)
  72   2                      {
  73   3                              if(!dismod_change)
  74   3                              {
  75   4                                      if(temp_change)
  76   4                                              higtemp = higtemp - 1;
  77   4                                      if(!temp_change)
  78   4                                      {
  79   5                                              lowtemp = lowtemp - 1;
  80   5                                      }
  81   4                                      lcd_write_com(0x82);
  82   4                                      lcd_disp_alarm(higtemp);
  83   4                                      lcd_write_com(0xC2);
  84   4                                      lcd_disp_alarm(lowtemp);
  85   4                                      lcd_dis_mod(2); 
  86   4                              }
  87   3                              while(!SW_4);      
  88   3                      }       
  89   2              }
  90   1      
  91   1              if(SW_5==0)                      //＋10开关
  92   1              {
  93   2                      delay1ms(10);      
  94   2                      if(SW_5==0)
  95   2                      {
  96   3                              if(!dismod_change)
  97   3                              {
  98   4                                      if(temp_change)
  99   4                                              higtemp = higtemp + 10;
 100   4                                      if(!temp_change)
 101   4                                      {
 102   5                                              lowtemp = lowtemp + 10;
 103   5                                      }
 104   4                                      lcd_write_com(0x82);
 105   4                                      lcd_disp_alarm(higtemp);
 106   4                                      lcd_write_com(0xC2);
 107   4                                      lcd_disp_alarm(lowtemp);
 108   4                                      lcd_dis_mod(2); 
 109   4                              }
 110   3                              while(!SW_5);     
 111   3                      }       
 112   2              }
 113   1      
 114   1              if(SW_6==0)                      //-10开关
 115   1              {
 116   2                      delay1ms(10);      
 117   2                      if(SW_6==0)
C51 COMPILER V9.01   KEYPAD                                                                05/08/2021 18:31:42 PAGE 3   

 118   2                      {
 119   3                              if(!dismod_change)
 120   3                              {
 121   4                                      if(temp_change)
 122   4                                              higtemp = higtemp - 10;
 123   4                                      if(!temp_change)
 124   4                                      {
 125   5                                              lowtemp = lowtemp - 10;
 126   5                                      }
 127   4                                      lcd_write_com(0x82);
 128   4                                      lcd_disp_alarm(higtemp);
 129   4                                      lcd_write_com(0xC2);
 130   4                                      lcd_disp_alarm(lowtemp);
 131   4                                      lcd_dis_mod(2); 
 132   4                              }
 133   3                              while(!SW_6);      
 134   3                      }       
 135   2              }
 136   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    304    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
